import{r as d,o as _,c as E,a as s,w,v as $,t as c,b as R,d as y,n as S,u as A,e as B,f as L,g as h,h as U,i as q,_ as M,j as N,L as Z}from"./index-PhCdCfx5.js";const G={class:"col-6"},I={class:"formControls"},K=s("h2",{class:"formControls_txt"},"註冊帳號",-1),V=s("label",{class:"formControls_label",for:"email"},"Email",-1),W=s("label",{class:"formControls_label",for:"name"},"您的暱稱",-1),F=s("label",{class:"formControls_label",for:"pwd"},"密碼",-1),H={style:{position:"relative"}},J=["type"],Q=s("label",{class:"formControls_label",for:"pwd"},"再次輸入密碼",-1),X={style:{position:"relative"}},Y=["type"],ee={__name:"RightInput4Area",props:{signUpData:Object,errors:Object,eyeOpen:Boolean,signUpResponse:String},emits:["show-password","sign-up","go-page"],setup(n,{emit:v}){const p=v,g=d("fa-solid fa-eye"),m=d("fa-solid fa-eye-slash");return(r,l)=>(_(),E("div",G,[s("form",I,[K,V,w(s("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email","onUpdate:modelValue":l[0]||(l[0]=t=>n.signUpData.email=t),required:""},null,512),[[$,n.signUpData.email]]),s("span",null,c(n.errors.email),1),W,w(s("input",{class:"formControls_input",type:"text",name:"name",id:"name",placeholder:"請輸入您的暱稱","onUpdate:modelValue":l[1]||(l[1]=t=>n.signUpData.nickname=t)},null,512),[[$,n.signUpData.nickname]]),s("span",null,c(n.errors.nickname),1),F,s("div",H,[w(s("input",{class:"formControls_input",type:[n.eyeOpen?"text":"password"],name:"pwd",id:"pwd",placeholder:"請輸入密碼","onUpdate:modelValue":l[2]||(l[2]=t=>n.signUpData.password=t),required:""},null,8,J),[[R,n.signUpData.password]]),s("a",{href:"#",class:"eye",onClick:l[3]||(l[3]=y(t=>p("show-password"),["prevent"]))},[s("i",{class:S([n.eyeOpen?g.value:m.value])},null,2)])]),s("span",null,c(n.errors.password),1),Q,s("div",X,[w(s("input",{class:"formControls_input",type:[n.eyeOpen?"text":"password"],name:"pwd2",id:"pwd2",placeholder:"請再次輸入密碼","onUpdate:modelValue":l[4]||(l[4]=t=>n.signUpData.password2=t),required:""},null,8,Y),[[R,n.signUpData.password2]]),s("a",{href:"#",class:"eye",onClick:l[5]||(l[5]=y(t=>p("show-password"),["prevent"]))},[s("i",{class:S([n.eyeOpen?g.value:m.value])},null,2)])]),s("span",null,c(n.errors.password2)+c(n.signUpResponse),1),s("input",{class:"formControls_btnSubmit",type:"button",onClick:l[6]||(l[6]=t=>p("sign-up")),value:"註冊帳號"}),s("a",{class:"formControls_btnLink",onClick:l[7]||(l[7]=y(t=>p("go-page"),["prevent"]))},"登入")])]))}},se={id:"signUpPage",class:"bg-yellow"},ae={class:"conatiner signUpPage vhContainer row"},le="https://todolist-api.hexschool.io",ne={__name:"SignUpPageView",setup(n){const v=A(),p=B(),g=L.useLoading({}),m=d(!1),r=d(!1),l=d([]);let t=d("");const o=d({email:"",password:"",nickname:"",password2:""}),e=d({email:"",password:"",nickname:"",password2:""}),k=()=>{p.push("/")},P=()=>{m.value=!m.value},j=a=>typeof a=="string",C=a=>{l.value.push({message:a}),setTimeout(()=>{l.value.shift()},3e3)},T=()=>e.value.email.length>0||e.value.nickname.length>0||e.value.password.length>0||e.value.password2.length>0?(C("有欄位錯誤無法註冊"),!0):!1;h(()=>o.value.email,a=>{if(r.value&&a.length===0)return;r.value;const f=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;a.length===0?e.value.email="email 欄位未提供":f.test(a)?e.value.email="":e.value.email="email 格式錯誤"}),h(()=>o.value.nickname,a=>{r.value&&a.length===0||(r.value,a.length>0?e.value.nickname="":e.value.nickname="nickname 欄位未提供")}),h(()=>o.value.password,a=>{if(!(r.value&&a.length===0))if(r.value,o.value.password.length<6&&o.value.password.length!==0){if(e.value.password="password 長度不足6個字",e.value.password2="",o.value.password2.length===0)return;a===o.value.password2?e.value.password2="":e.value.password2="password 不一致"}else{if(e.value.password="",o.value.password2.length===0)return;a===o.value.password2?e.value.password2="":e.value.password2="password 不一致"}}),h(()=>o.value.password2,a=>{r.value&&a.length===0||(r.value,a===o.value.password?e.value.password2="":e.value.password2="password 不一致")});const z=async()=>{var f,x,O,b,D;if(T())return;const a=g.show({backgroundColor:"#ffffff",opacity:.9});try{const i=await N.post(`${le}/users/sign_up`,o.value);setTimeout(()=>{a.hide()},800),t.value="註冊成功! 請使用"+o.value.email+"來登入系統",v.myEmail=o.value.email+"",v.myPassword=o.value.password+"",v.myUid=o.value.uid+"",r.value=!0,o.value={email:"",password:"",nickname:"",password2:""},e.value={email:"",password:"",nickname:"",password2:""},setTimeout(()=>{k()},2e3)}catch(i){setTimeout(()=>{a.hide()},800),r.value=!0,e.value={email:"",password:"",nickname:"",password2:""},t.value="",i.code==="ERR_NETWORK"?C("錯誤:"+i.message):(j((f=i.response.data)==null?void 0:f.message)?i.response.data.message.indexOf("用戶已存在")!==-1?e.value.email=((x=i.response.data)==null?void 0:x.message)+": "+o.value.email:t.value=i.response.data.message:(i.response.data.message.filter(u=>u.indexOf("email")!==-1)&&(e.value.email=(O=i.response.data)==null?void 0:O.message.filter(u=>u.indexOf("email")!==-1).join()),i.response.data.message.filter(u=>u.indexOf("nickname")!==-1)&&(e.value.nickname=(b=i.response.data)==null?void 0:b.message.filter(u=>u.indexOf("nickname")!==-1).join()),i.response.data.message.filter(u=>u.indexOf("password")!==-1)&&(e.value.password=(D=i.response.data)==null?void 0:D.message.filter(u=>u.indexOf("password")!==-1).join())),o.value={email:"",password:"",nickname:"",password2:""})}};return(a,f)=>(_(),E("div",se,[s("div",ae,[U(Z),U(ee,{signUpData:o.value,errors:e.value,eyeOpen:m.value,signUpResponse:q(t),onShowPassword:P,onSignUp:z,onGoPage:k},null,8,["signUpData","errors","eyeOpen","signUpResponse"]),U(M,{toasts:l.value},null,8,["toasts"])])]))}};export{ne as default};
