import{o as $,c as P,a as s,w,v as D,t as c,b as S,d as C,n as R,u as A,e as T,r as d,f as h,g as U,h as L,_ as M,i as N,L as Z}from"./index-CPAv3QJh.js";const _={class:"col-6"},G={class:"formControls"},I=s("h2",{class:"formControls_txt"},"註冊帳號",-1),K=s("label",{class:"formControls_label",for:"email"},"Email",-1),V=s("label",{class:"formControls_label",for:"name"},"您的暱稱",-1),W=s("label",{class:"formControls_label",for:"pwd"},"密碼",-1),F={style:{position:"relative"}},H=["type"],J=s("label",{class:"formControls_label",for:"pwd"},"再次輸入密碼",-1),Q={style:{position:"relative"}},X=["type"],Y={__name:"RightInput4Area",props:{signUpData:Object,errors:Object,eyeOpen:Boolean,showEyeClass:String,closeEyeClass:String,signUpResponse:String},emits:["show-password","sign-up","go-page"],setup(a,{emit:m}){const p=m;return(f,n)=>($(),P("div",_,[s("form",G,[I,K,w(s("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email","onUpdate:modelValue":n[0]||(n[0]=i=>a.signUpData.email=i),required:""},null,512),[[D,a.signUpData.email]]),s("span",null,c(a.errors.email),1),V,w(s("input",{class:"formControls_input",type:"text",name:"name",id:"name",placeholder:"請輸入您的暱稱","onUpdate:modelValue":n[1]||(n[1]=i=>a.signUpData.nickname=i)},null,512),[[D,a.signUpData.nickname]]),s("span",null,c(a.errors.nickname),1),W,s("div",F,[w(s("input",{class:"formControls_input",type:[a.eyeOpen?"text":"password"],name:"pwd",id:"pwd",placeholder:"請輸入密碼","onUpdate:modelValue":n[2]||(n[2]=i=>a.signUpData.password=i),required:""},null,8,H),[[S,a.signUpData.password]]),s("a",{href:"#",class:"eye",onClick:n[3]||(n[3]=C(i=>p("show-password"),["prevent"]))},[s("i",{class:R([a.eyeOpen?a.showEyeClass:a.closeEyeClass])},null,2)])]),s("span",null,c(a.errors.password),1),J,s("div",Q,[w(s("input",{class:"formControls_input",type:[a.eyeOpen?"text":"password"],name:"pwd2",id:"pwd2",placeholder:"請再次輸入密碼","onUpdate:modelValue":n[4]||(n[4]=i=>a.signUpData.password2=i),required:""},null,8,X),[[S,a.signUpData.password2]]),s("a",{href:"#",class:"eye",onClick:n[5]||(n[5]=C(i=>p("show-password"),["prevent"]))},[s("i",{class:R([a.eyeOpen?a.showEyeClass:a.closeEyeClass])},null,2)])]),s("span",null,c(a.errors.password2)+c(a.signUpResponse),1),s("input",{class:"formControls_btnSubmit",type:"button",onClick:n[6]||(n[6]=i=>p("sign-up")),value:"註冊帳號"}),s("a",{class:"formControls_btnLink",onClick:n[7]||(n[7]=C(i=>p("go-page"),["prevent"]))},"登入")])]))}},ee={id:"signUpPage",class:"bg-yellow"},se={class:"conatiner signUpPage vhContainer row"},ae="https://todolist-api.hexschool.io",oe={__name:"SignUpPageView",setup(a){const m=A(),p=T(),f=d(!1),n=d("fa-solid fa-eye"),i=d("fa-solid fa-eye-slash"),u=d(!1),y=d([]);let g=d("");const l=d({email:"",password:"",nickname:"",password2:""}),e=d({email:"",password:"",nickname:"",password2:""}),k=()=>{p.push("/")},j=()=>{f.value=!f.value},B=o=>typeof o=="string",x=o=>{y.value.push({message:o}),setTimeout(()=>{y.value.shift()},3e3)},q=()=>e.value.email.length>0||e.value.nickname.length>0||e.value.password.length>0||e.value.password2.length>0?(x("有欄位錯誤無法註冊"),!0):!1;h(()=>l.value.email,o=>{if(u.value&&o.length===0)return;u.value;const v=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;o.length===0?e.value.email="email 欄位未提供":v.test(o)?e.value.email="":e.value.email="email 格式錯誤"}),h(()=>l.value.nickname,o=>{u.value&&o.length===0||(u.value,o.length>0?e.value.nickname="":e.value.nickname="nickname 欄位未提供")}),h(()=>l.value.password,o=>{if(!(u.value&&o.length===0))if(u.value,l.value.password.length<6&&l.value.password.length!==0){if(e.value.password="password 長度不足6個字",e.value.password2="",l.value.password2.length===0)return;o===l.value.password2?e.value.password2="":e.value.password2="password 不一致"}else{if(e.value.password="",l.value.password2.length===0)return;o===l.value.password2?e.value.password2="":e.value.password2="password 不一致"}}),h(()=>l.value.password2,o=>{u.value&&o.length===0||(u.value,o===l.value.password?e.value.password2="":e.value.password2="password 不一致")});const z=async()=>{var o,v,E,O,b;if(!q()){console.log(l.value);try{const t=await N.post(`${ae}/users/sign_up`,l.value);g.value="註冊成功! 請使用"+l.value.email+"來登入系統",m.myEmail=l.value.email+"",m.myPassword=l.value.password+"",m.myUid=l.value.uid+"",u.value=!0,l.value={email:"",password:"",nickname:"",password2:""},e.value={email:"",password:"",nickname:"",password2:""},setTimeout(()=>{k()},2e3)}catch(t){t.response&&t.response.status===400&&console.log("Bad Request: ",t),u.value=!0,e.value={email:"",password:"",nickname:"",password2:""},g.value="",t.code==="ERR_NETWORK"?x("錯誤:"+t.message):(B((o=t.response.data)==null?void 0:o.message)?t.response.data.message.indexOf("用戶已存在")!==-1?e.value.email=((v=t.response.data)==null?void 0:v.message)+": "+l.value.email:g.value=t.response.data.message:(t.response.data.message.filter(r=>r.indexOf("email")!==-1)&&(e.value.email=(E=t.response.data)==null?void 0:E.message.filter(r=>r.indexOf("email")!==-1).join()),t.response.data.message.filter(r=>r.indexOf("nickname")!==-1)&&(e.value.nickname=(O=t.response.data)==null?void 0:O.message.filter(r=>r.indexOf("nickname")!==-1).join()),t.response.data.message.filter(r=>r.indexOf("password")!==-1)&&(e.value.password=(b=t.response.data)==null?void 0:b.message.filter(r=>r.indexOf("password")!==-1).join())),l.value={email:"",password:"",nickname:"",password2:""})}}};return(o,v)=>($(),P("div",ee,[s("div",se,[U(Z),U(Y,{signUpData:l.value,errors:e.value,eyeOpen:f.value,"showEyeClass:":n.value,closeEyeClass:i.value,signUpResponse:L(g),onShowPassword:j,onSignUp:z,onGoPage:k},null,8,["signUpData","errors","eyeOpen","showEyeClass:","closeEyeClass","signUpResponse"]),U(M,{toasts:y.value},null,8,["toasts"])])]))}};export{oe as default};
