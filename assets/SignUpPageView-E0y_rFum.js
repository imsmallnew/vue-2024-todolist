import{r as u,o as S,c as _,a,w as g,v as b,t as f,b as D,d as h,n as R,u as B,e as q,f as w,g as y,h as z,_ as A,i as T,L}from"./index-BKZgOjK_.js";const M={class:"col-6"},N={class:"formControls"},Z=a("h2",{class:"formControls_txt"},"註冊帳號",-1),G=a("label",{class:"formControls_label",for:"email"},"Email",-1),I=a("label",{class:"formControls_label",for:"name"},"您的暱稱",-1),K=a("label",{class:"formControls_label",for:"pwd"},"密碼",-1),V={style:{position:"relative"}},W=["type"],F=a("label",{class:"formControls_label",for:"pwd"},"再次輸入密碼",-1),H={style:{position:"relative"}},J=["type"],Q={__name:"RightInput4Area",props:{signUpData:Object,errors:Object,eyeOpen:Boolean,signUpResponse:String},emits:["show-password","sign-up","go-page"],setup(o,{emit:m}){const p=m,d=u("fa-solid fa-eye"),i=u("fa-solid fa-eye-slash");return(c,l)=>(S(),_("div",M,[a("form",N,[Z,G,g(a("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email","onUpdate:modelValue":l[0]||(l[0]=e=>o.signUpData.email=e),required:""},null,512),[[b,o.signUpData.email]]),a("span",null,f(o.errors.email),1),I,g(a("input",{class:"formControls_input",type:"text",name:"name",id:"name",placeholder:"請輸入您的暱稱","onUpdate:modelValue":l[1]||(l[1]=e=>o.signUpData.nickname=e)},null,512),[[b,o.signUpData.nickname]]),a("span",null,f(o.errors.nickname),1),K,a("div",V,[g(a("input",{class:"formControls_input",type:[o.eyeOpen?"text":"password"],name:"pwd",id:"pwd",placeholder:"請輸入密碼","onUpdate:modelValue":l[2]||(l[2]=e=>o.signUpData.password=e),required:""},null,8,W),[[D,o.signUpData.password]]),a("a",{href:"#",class:"eye",onClick:l[3]||(l[3]=h(e=>p("show-password"),["prevent"]))},[a("i",{class:R([o.eyeOpen?d.value:i.value])},null,2)])]),a("span",null,f(o.errors.password),1),F,a("div",H,[g(a("input",{class:"formControls_input",type:[o.eyeOpen?"text":"password"],name:"pwd2",id:"pwd2",placeholder:"請再次輸入密碼","onUpdate:modelValue":l[4]||(l[4]=e=>o.signUpData.password2=e),required:""},null,8,J),[[D,o.signUpData.password2]]),a("a",{href:"#",class:"eye",onClick:l[5]||(l[5]=h(e=>p("show-password"),["prevent"]))},[a("i",{class:R([o.eyeOpen?d.value:i.value])},null,2)])]),a("span",null,f(o.errors.password2)+f(o.signUpResponse),1),a("input",{class:"formControls_btnSubmit",type:"button",onClick:l[6]||(l[6]=e=>p("sign-up")),value:"註冊帳號"}),a("a",{class:"formControls_btnLink",onClick:l[7]||(l[7]=h(e=>p("go-page"),["prevent"]))},"登入")])]))}},X={id:"signUpPage",class:"bg-yellow"},Y={class:"conatiner signUpPage vhContainer row"},ee="https://todolist-api.hexschool.io",ae={__name:"SignUpPageView",setup(o){const m=B(),p=q(),d=u(!1),i=u(!1),c=u([]);let l=u("");const e=u({email:"",password:"",nickname:"",password2:""}),s=u({email:"",password:"",nickname:"",password2:""}),U=()=>{p.push("/")},$=()=>{d.value=!d.value},P=n=>typeof n=="string",k=n=>{c.value.push({message:n}),setTimeout(()=>{c.value.shift()},3e3)},E=()=>s.value.email.length>0||s.value.nickname.length>0||s.value.password.length>0||s.value.password2.length>0?(k("有欄位錯誤無法註冊"),!0):!1;w(()=>e.value.email,n=>{if(i.value&&n.length===0)return;i.value;const v=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;n.length===0?s.value.email="email 欄位未提供":v.test(n)?s.value.email="":s.value.email="email 格式錯誤"}),w(()=>e.value.nickname,n=>{i.value&&n.length===0||(i.value,n.length>0?s.value.nickname="":s.value.nickname="nickname 欄位未提供")}),w(()=>e.value.password,n=>{if(!(i.value&&n.length===0))if(i.value,e.value.password.length<6&&e.value.password.length!==0){if(s.value.password="password 長度不足6個字",s.value.password2="",e.value.password2.length===0)return;n===e.value.password2?s.value.password2="":s.value.password2="password 不一致"}else{if(s.value.password="",e.value.password2.length===0)return;n===e.value.password2?s.value.password2="":s.value.password2="password 不一致"}}),w(()=>e.value.password2,n=>{i.value&&n.length===0||(i.value,n===e.value.password?s.value.password2="":s.value.password2="password 不一致")});const j=async()=>{var n,v,C,x,O;if(!E()){console.log(e.value);try{const t=await T.post(`${ee}/users/sign_up`,e.value);l.value="註冊成功! 請使用"+e.value.email+"來登入系統",m.myEmail=e.value.email+"",m.myPassword=e.value.password+"",m.myUid=e.value.uid+"",i.value=!0,e.value={email:"",password:"",nickname:"",password2:""},s.value={email:"",password:"",nickname:"",password2:""},setTimeout(()=>{U()},2e3)}catch(t){t.response&&t.response.status===400&&console.log("Bad Request: ",t),i.value=!0,s.value={email:"",password:"",nickname:"",password2:""},l.value="",t.code==="ERR_NETWORK"?k("錯誤:"+t.message):(P((n=t.response.data)==null?void 0:n.message)?t.response.data.message.indexOf("用戶已存在")!==-1?s.value.email=((v=t.response.data)==null?void 0:v.message)+": "+e.value.email:l.value=t.response.data.message:(t.response.data.message.filter(r=>r.indexOf("email")!==-1)&&(s.value.email=(C=t.response.data)==null?void 0:C.message.filter(r=>r.indexOf("email")!==-1).join()),t.response.data.message.filter(r=>r.indexOf("nickname")!==-1)&&(s.value.nickname=(x=t.response.data)==null?void 0:x.message.filter(r=>r.indexOf("nickname")!==-1).join()),t.response.data.message.filter(r=>r.indexOf("password")!==-1)&&(s.value.password=(O=t.response.data)==null?void 0:O.message.filter(r=>r.indexOf("password")!==-1).join())),e.value={email:"",password:"",nickname:"",password2:""})}}};return(n,v)=>(S(),_("div",X,[a("div",Y,[y(L),y(Q,{signUpData:e.value,errors:s.value,eyeOpen:d.value,signUpResponse:z(l),onShowPassword:$,onSignUp:j,onGoPage:U},null,8,["signUpData","errors","eyeOpen","signUpResponse"]),y(A,{toasts:c.value},null,8,["toasts"])])]))}};export{ae as default};
